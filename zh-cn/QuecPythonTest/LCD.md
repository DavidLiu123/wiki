# QuecPython LCD显示说明

**平台说明**

| 型号     | 详情                                      |
| -------- | ----------------------------------------- |
| LCD 型号 | 驱动芯片：ST7789V<br/>尺寸规格：240 x 240 |
| 模块型号 | EC600S/EC100Y                             |
| 开发板   | EC600S_QuecPython_EVB_V1.1                |

**开发板lcd接口说明**

本实验所使用的ST7789V lcd引脚定义与开发板的LCD接口是完全匹配的，可以直接插到开发板的LCD接口使用。开发板LCD接口如下：

![lcd接口说明](media\lcd接口说明.png)

| 开发板lcd引脚 | 引脚定义                       |
| ------------- | ------------------------------ |
| GND           | 电源地                         |
| VCC           | 电源3.3V                       |
| SCL           | SPI总线时钟信号                |
| SDA           | SPI总线写数据信号              |
| RST           | 液晶屏复位控制信号，低电平复位 |
| DC            | 写寄存器/写数据控制信号        |
| BLK           | 液晶屏背光控制信号             |

**ST7789V lcd 接口说明**

<img src="media\st7789v.png" alt="st7789v" style="zoom:75%;" />



| lcd引脚 | 引脚定义                       |
| ------- | ------------------------------ |
| GND     | 电源地                         |
| VCC     | 电源3.3V                       |
| SCL     | SPI总线时钟信号                |
| SDA     | SPI总线写数据信号              |
| RES     | 液晶屏复位控制信号，低电平复位 |
| DC      | 写寄存器/写数据控制信号        |
| BLK     | 液晶屏背光控制信号             |

## 软件接口

本示例中的接口是基于QuecPython 的machine.LCD库实现，具体可阅读示例程序的源码。

### ST7789V LCD 显示驱动

在例程的“显示图片”和“显示字符”目录下，都能看到文件 st7789v.py，该文件中提供了ST7789V 液晶屏的显示驱动初始化、显示图片、显示汉字以及显示ASCII字符的方法。

使用方式如下：

（1）将 st7789v.py 上传了模块的 usr 目录；

（2）创建st7789v lcd 对象

```
from usr import st7789v

lcd_st7789v = st7789v.ST7789V(width, hight) # 参数为显示屏的宽高
```

（3）创建对象成功后，即可使用对象中的方法。



### 方法说明

> **lcd_st7789v.lcd_set_display_area(args)**

功能：

设置显示的区域，用户需要调用这个方法，该方法是由底层函数来调用。对于本示例中用的这款 st7789v lcd，用户不需要修改该方法。

参数：

| 参数    | 类型 | 说明        |
| ------- | ---- | ----------- |
| args[0] | 整型 | x轴起点坐标 |
| args[1] | 整型 | y轴起点坐标 |
| args[2] | 整型 | x轴终点坐标 |
| args[3] | 整型 | y轴终点坐标 |



> **lcd_st7789v.lcd_show_char(x, y, xsize, ysize, ch_buf, fc, bc)**

功能：

单个字符显示，可显示汉字和ASCII字符。

参数：

| 参数   | 类型         | 说明                          |
| ------ | ------------ | ----------------------------- |
| x      | 整型         | x轴起点坐标                   |
| y      | 整型         | y轴起点坐标                   |
| xsize  | 整型         | 待显示字符的宽                |
| ysize  | 整型         | 待显示字符的高                |
| ch_buf | 元组或列表   | 存放待显示字符的字模数据      |
| fc     | 16位十六进制 | 字体颜色，如 0x0000 表示黑色  |
| bc     | 16位十六进制 | 背景颜色，如 0xFFFF  表示白色 |



> **lcd_st7789v.lcd_show_ascii(x, y, xsize, ysize, ch_buf, fc, bc)**

功能：

ASCII字符显示，目前支持8x16、16x24的字体大小，如果需要其他字体大小需要自己增加对应大小的字库数据，并在该函数中增加这个对应字库的字典。

参数：

| 参数  | 类型         | 说明                          |
| ----- | ------------ | ----------------------------- |
| x     | 整型         | x轴起点坐标                   |
| y     | 整型         | y轴起点坐标                   |
| xsize | 整型         | 待显示字符的宽                |
| ysize | 整型         | 待显示字符的高                |
| ch    | 字符         | 待显示的ASCII字符             |
| fc    | 16位十六进制 | 字体颜色，如 0x0000 表示黑色  |
| bc    | 16位十六进制 | 背景颜色，如 0xFFFF  表示白色 |



> **lcd_st7789v.lcd_show_chinese(x, y, xsize, ysize, ch_buf, fc, bc)**

功能：

汉字显示，目前支持示例中几个汉字的16x16、16x24、24x24的字体大小，如果需要显示其他汉字以及其他字体大小需要自己增加对应大小的字库数据，并在该函数中增加这个对应字库的字典。

参数：

| 参数  | 类型         | 说明                          |
| ----- | ------------ | ----------------------------- |
| x     | 整型         | x轴起点坐标                   |
| y     | 整型         | y轴起点坐标                   |
| xsize | 整型         | 待显示字符的宽                |
| ysize | 整型         | 待显示字符的高                |
| ch    | 字符         | 待显示的汉字                  |
| fc    | 16位十六进制 | 字体颜色，如 0x0000 表示黑色  |
| bc    | 16位十六进制 | 背景颜色，如 0xFFFF  表示白色 |



> **lcd_st7789v.lcd_show_image(image_data, x, y, width, heigth)**

功能：

图片显示，除了传入显示数据，还需要传入显示的起点坐标和图片的宽高，注意，是图片的宽高，不是终点坐标。

参数：

| 参数       | 类型       | 说明                    |
| ---------- | ---------- | ----------------------- |
| image_data | 元组或列表 | 存放待显示图片的RGB数据 |
| x          | 整型       | x轴起点坐标             |
| y          | 整型       | y轴起点坐标             |
| width      | 整型       | 待显示图片的宽度        |
| heigth     | 字符       | 待显示图片的高度        |

注意：

显示图片的RGB数据不要太大，否则会导致内存分配失败。



## 示例



### 显示图片

在实验例程的目录下，找到【显示图片】目录，进入该目录下，有如下几个源码文件：

| 文件                     | 说明                                                         |
| ------------------------ | ------------------------------------------------------------ |
| st7789v.py               | 包含 ST7789V lcd 驱动初始化、写ASCII字符、写汉字以及显示图片的方法接口。 |
| image.py                 | 示例图片的RGB数据                                            |
| example_display_image.py | 主程序，调用st7789v.py和image.py中接口及信息来实现图片显示   |

使用方法步骤：
（1）将240*240的显示屏正确接到模块上；
（2）将本目录的3个py文件（st7789v.py、image.py、example_display_image.py）拷贝到模块的usr目录下；
（3）进入模块的命令行，执行如下指令即可看到显示屏显示图片：

```
import example
example.exec('usr/example_display_image.py')
```

实验结果：

![图片显示实验](media\图片显示实验.png)





### 显示字符

在实验例程的目录下，找到【显示字符】目录，进入该目录下，有如下几个源码文件：

| 文件                    | 说明                                                         |
| ----------------------- | ------------------------------------------------------------ |
| st7789v.py              | 包含 ST7789V lcd 驱动初始化、写ASCII字符、写汉字以及显示图片的方法接口。 |
| fonts.py                | 字库，提供常见ASCII字符的两种大小的字库，分别是8x16和16x24，同时包含了实验中用到汉字的几种不同大小的字库。用户可根据自己的需要制作字库，使用PCtoLCD2002软件，参照fonts.py中说明来制作。 |
| example_display_char.py | 主程序，调用st7789v.py和fonts.py中接口及信息来实现ASCII字符的显示与汉字的显示。 |

使用方法步骤：
（1）将240*240的显示屏正确接到模块上；
（2）将本目录的3个py文件（st7789v.py、fonts.py、example_display_char.py）拷贝到模块的usr目录下；
（3）进入模块的命令行，执行如下指令即可看到显示屏显示图片：

```
import example
example.exec('usr/example_display_char.py')
```

实验结果：

![字符显示实验](media\字符显示实验.jpg)



## 工具使用



### 工具简介

（1）Image2Lcd

Image2Lcd 软件用于图片取模，可以提取单色和彩色图片。

（2）PCtoLCD2002

PCtoLCD2002 是一款字符取模软件，可以生成汉字、英文以及标点符号的字模数据。



### 如何对图片取模

（1）打开 Image2Lcd 软件，点击【打开】按钮，选择要显示的图片；

![图片取模](media\图片取模.png)

（2）输出数据类型选择【C语言数组(*.c)】,扫描方式选择【水平扫描】，输出灰度一定要选择【16位真彩色】；

（3）设置图片的最大宽度和高度，实际输出大小以上图中最下方的【输出图像:（xx, yy）】部分显示为准；

（4）点击【保存】按钮，得到图片的取模数据，将其放到元组中保存即可。



### 如何对字符取模

（1）打开 PCtoLCD2002 软件，依次点击【模式】-【字符模式(W)】；

（2）根据需要选择字体，设置字体大小等；

![字符取模1](media\字符取模1.png)

（3）点击齿轮图标，进入如下所示界面，选择 【阴码】、【逐行式】、【顺向】、【C51格式】，点击确定；

![字符取模2](media\字符取模2.png)

（4）输入要取模的字符后，点击【生成字模】，即可得到对应的字模数据，按照示例 fonts.py 文件中的格式，将字模数据保存到字典中。

# 配套实验材料

<!-- * [下载文件](code/LCD_file.zip) -->
 <a href="zh-cn/QuecPythonTest/code/LCD_file.zip" target="_blank">下载文件</a>